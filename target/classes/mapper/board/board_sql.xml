<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">
	<sql id="COMMON_PAGING_HEADER">
		select R.* FROM(	
	</sql>
	
	<sql id="COMMON_PAGING_TAIL">
		) R
		LIMIT #{listNum, jdbcType=INTEGER} OFFSET #{start, jdbcType=INTEGER}	
	</sql>

    
    <select id="boardList" parameterType="BoardVO" resultType="BoardVO">
      <include refid="COMMON_PAGING_HEADER"/>
      <![CDATA[
		    select 
			    boardIdx
				,id
				,title
				,content
				,hitCnt
				,ip
				,ins_dt
				,upt_dt
		    from board
		]]> 
		<where>
		<if test="keyWord != null and keyWord != ''">   
				<if test="keyField == 'name'">
					and id = #{keyWord, jdbcType=VARCHAR}
				</if>
				<if test="keyField == 'title'">
					and title = #{keyWord, jdbcType=VARCHAR}
				</if>
				<if test="keyField == 'content'">
					and content = #{keyWord, jdbcType=VARCHAR}
				</if>	
		</if>
		</where>
		<![CDATA[
    		order by boardIdx desc
		]]> 
      <include refid="COMMON_PAGING_TAIL"/>
    </select> 
    
	<select id="boardListCnt" parameterType="BoardVO" resultType="integer">
      <![CDATA[
		    select count(1) as cnt
		    from board
		]]> 
		<where>
		<if test="keyWord != null and keyWord != ''">   
				<if test="keyField == 'name'">
					and id = #{keyWord, jdbcType=VARCHAR}
				</if>
				<if test="keyField == 'title'">
					and title = #{keyWord, jdbcType=VARCHAR}
				</if>
				<if test="keyField == 'content'">
					and content = #{keyWord, jdbcType=VARCHAR}
				</if>	
		</if>
		</where>
    </select> 

	<select id="findByIdx" parameterType="int" resultType="BoardVO">
      <![CDATA[
		select * from board 
		]]>
		where boardIdx = #{boardIdx} 
    </select>
    
    
    
   	<update id="readCount">
		<![CDATA[
		update board set hitCnt = hitCnt + 1 where boardIdx = #{boardIdx}
		]]>
    </update>  
    
 
    
</mapper>
